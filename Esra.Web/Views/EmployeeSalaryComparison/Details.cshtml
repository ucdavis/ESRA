@model Esra.Web.Models.EmployeeSalaryComparisonViewModel
@using System.Text;
@{
    ViewBag.Title = "Employee Salary Comparison";
}
@section SubNav
{
    <ul class="navigation">
        <li>@Html.ActionLink("Edit", "Edit", new { /* id=Model.PrimaryKey */ }) </li>
        <li>@Html.ActionLink("Back to List", "Index")</li>
    </ul>
}
<div id="salary-scale">
    @Html.AntiForgeryToken()
    @Html.Partial("_SalaryScaleSelectLists", Model.SalaryScaleViewModel)
    @*<div id="salaryscale-result" />*@
    <script language="JavaScript" type="text/javascript">
        $(function () {
            var dtable = $('#employees').dataTable({
                "bProcessing": true,
                //"bServerSide": true,
                "bJQueryUI": true,
                "sPaginationType": "full_numbers"
            });

            $('#employees a.edit-row').live('click', function (e) {
                var row = this.parentNode.parentNode;
                dtable.fnOpen(row, fnFormatDetails(dtable, row), 'details');
                e.preventDefault();
            });

            $('#employees a.close-row').live('click', function (e) {
                var row = this.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.previousSibling;
                dtable.fnClose(row);
                e.preventDefault();
            });

            $('#titlecode-drop-down').change(function () {
                //debugger;

                var selectedText = $(this).find('option:selected').text();
                var otherControl = $('#title-drop-down');
                otherControl.val($(this).val());

                var token = $('[name=__RequestVerificationToken]').val();

                $.post('/SalaryScale/_SalaryScale',
                { __RequestVerificationToken: token, titleCode: $(this).val() },
                function (result) {
                    if (result.length > 50) {
                        $("#salary-scale-partial").html(result.toString());
                    }
                    else {
                        $("#salary-scale-partial").html("<fieldset><h3>No Salary Data Available</h3></fieldset>");
                    }
                }
            );
            });

            $('#title-drop-down').change(function () {
                //debugger;

                var selectedText = $(this).find('option:selected').text();
                var otherControl = $('#titlecode-drop-down');
                otherControl.val($(this).val());

                var token = $('[name=__RequestVerificationToken]').val();

                $.post('/SalaryScale/_SalaryScale',
                { __RequestVerificationToken: token, titleCode: $(this).val() },
                function (result) {
                    if (result.length > 50) {
                        $("#salary-scale-partial").html(result.toString());
                    }
                    else {
                        $("#salary-scale-partial").html("<fieldset><h3>No Salary Data Available</h3></fieldset>");
                    }
                }
            );
            });
        });

        /* Formating function for row details */
        function fnFormatDetails(dTable, row) {

            var aData = dTable.fnGetData(row);
            // var sOut = aData[5] + '<table cellpadding="5" cellspacing="0" border="0" style="padding-left:50px;">';
            //            sOut += '<tr><td>Hire Date:</td><td><input type="text" value="' + aData[6] + '"/></td></tr>';
            //            sOut += '<tr><td>Begin Date:</td><td><input type="text" value="' + aData[8] + '"/></td></tr>';
            //            sOut += '<tr><td>Experience Begin Date:</td><td><input type="text" value="' + aData[10] + '"/></td></tr>';
            //            sOut += '<tr><td>Extra info:</td><td>And any further details here (images etc)</td></tr>';
            //            sOut += '<tr><td>&nbsp;</td><td><input type="submit" value="Save" /><a class="close-row" href="#">Close</a></td></tr>';
            //            sOut += '</table>';

            var sOut = '';
            sOut += '<table cellpadding="5" cellspacing="0" border="0" style="padding-left:50px;">';
            sOut += '<tr><th>Department:</th><th>Title Code:</th><th>Salary Grade:</th><th>Bargaining<br />Unit:</th>';
            sOut += '<th>Employee<br />Name:</th><th>Hire Date:</th><th>Years<br />of<br />Service:</th><th>Begin Date<br />(in Title):</th>';
            sOut += '<th>Time<br />in<br />Title:</th><th>Experience Begin Date:</th><th>Years<br />of<br />Experience:</th>';
            sOut += '<th>Pay Rate:</th><th>Department<br/ >Comments:</th><th>Dean' + "'" + 's Office<br />Comments:</th>';

            sOut += '<tr><td><br /><input type="text" disabled="true" value="' + aData[1] + '"/></td><td><br /><input type="text" disabled="true" value="' + aData[2] + '"/></td>';
            sOut += '<td><br /><input type="text" disabled="true" value="' + aData[3] + '"/></td><td><br /><input type="text" disabled="true" value="' + aData[4] + '"/></td>';
            sOut += '<td><br /><input type="text" disabled="true" value="' + aData[5] + '"/></td>';
            sOut += '<td>PPS Checked?&nbsp;&nbsp;<input type="checkbox" ' + (aData[7] == "Y" ? 'checked' : String.Empty) + ' /> <br /><input type="text" value="' + aData[6] + '"/></td>';
            sOut += '<td><br /><input type="text" disabled="true" value="' + aData[8] + '"/></td>';
            sOut += '<td>PPS Checked?&nbsp;&nbsp;<input type="checkbox" ' + (aData[10] == "Y" ? 'checked' : String.Empty) + ' /> <br /><input type="text" value="' + aData[9] + '"/></td>';
            sOut += '<td><br /><input type="text" disabled="true" value="' + aData[11] + '"/></td>';
            sOut += '<td><br /><input type="text" value="' + aData[12] + '"/></td><td><br /><input type="text" disabled="true" value="' + aData[13] + '"/></td>';
            sOut += '<td><br /><input type="text" disabled="true" value="' + aData[14] + '"/></td>';
            sOut += '<td><textarea name="tbDeansOfficeComments" rows="3" cols="20">' + aData[15] + '</textarea></td>';
            sOut += '<td><textarea name="tbDepartmentComments" rows="3" cols="20" >' + aData[16] + '</textarea></td></tr>';
            sOut += '<tr><td>&nbsp;</td><td><input type="submit" value="Save" />&nbsp;&nbsp;<a class="close-row" href="#">Close</a></td></tr>';
            sOut += '</table>';
            return sOut;

            //            var sb = new System.Text.StringBuilder();
            //            sb.Append('<table cellpadding="5" cellspacing="0" border="0" style="padding-left:50px;">');
            //            sb.Append('<tr><th>Department</th><th>Title Code</th><th>Salary Grade</th><th>Bargaining<br />Unit</th>');
            //            sb.Append('<th>Employee<br />Name</th><th>Hire Date:</th><th>Years<br />of<br />Service</th><th>Begin Date<br />(in Title):</th>');
            //            sb.Append('<th>Time<br />in<br />Title</th><th>Experience Begin Date:</th><th>Years<br />of<br />Experience</th>');
            //            sb.Append('<th>Pay Rate</th><th>Department<br/ >Comments:</th><th>Deans Office<br />Comments:</th>');
            //            sb.Append('<tr><td><br /><input type="text" disabled="true" value="' + aData[1] + '"/></td><td><br /><input type="text" disabled="true" value="' + aData[2] + '"/></td>');
            //            sb.Append('<td><br /><input type="text" disabled="true" value="' + aData[3] + '"/>';</td><td><br /><input type="text" disabled="true" value="' + aData[4] + '"/></td>');
            //            sb.Append('<td><br /><input type="text" disabled="true" value="' + aData[5] + '"/></td>');
            //            sb.Append('<td>PPS Checked?&nbsp;&nbsp;<input type="checkbox" ' + (aData[7] == "Y" ? 'checked' : String.Empty) + ' /> <br /><input type="text" value="' + aData[6] + '"/></td>');
            //            sb.Append('<td><br /><input type="text" disabled="true" value="' + aData[8] + '"/></td>');
            //            sb.Append('<td>PPS Checked?&nbsp;&nbsp;<input type="checkbox" ' + (aData[10] == "Y" ? 'checked' : String.Empty) + ' /> <br /><input type="text" value="' + aData[9] + '"/></td>');
            //            sb.Append('<td><br /><input type="text" disabled="true" value="' + aData[11] + '"/></td>');
            //            sb.Append('<td><br /><input type="text" value="' + aData[12] + '"/></td><td><br /><input type="text" value="' + aData[13] + '"/></td>');
            //            sb.Append('<td><br /><input type="text" value="' + aData[14] + '"/></td>');
            //            sb.Append('<td><textarea name="tbDeansOfficeComments" rows="3" cols="20">' + aData[15] + '</textarea></td>');
            //            sb.Append('<td><textarea name="tbDepartmentComments" rows="3" cols="20" >' + aData[16] + '</textarea></td></tr>');
            //            sb.Append('<tr><td>&nbsp;</td><td><input type="submit" value="Save" />&nbsp;&nbsp;<a class="close-row" href="#">Close</a></td></tr>');
            //            sb.Append('</table>');
            //            return sb.ToString();
        }
    </script>
</div>
<div id="salary-scale-partial">
    @{
        @Html.Partial("_SalaryScale", Model.SalaryScaleViewModel)
    }
</div>
<div id="employee-drop-down-lists">
    @Html.Partial("_EmployeeTitleDepartmentSelectLists")
</div>
<div id="report-generation-criteria">
    @Html.Partial("_ReportGenerationCriteria")
</div>
<div id="result">
    @{
        if (Model.Employees != null && Model.Employees.Count() > 0)
        {
        @Html.Partial("_Employees")
        }
        else
        {
        <fieldset>
            <h3>
                No Employees Found</h3>
        </fieldset>
        }
    }
</div>